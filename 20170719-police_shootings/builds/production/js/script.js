!function t(e,a,s){function r(i,n){if(!a[i]){if(!e[i]){var d="function"==typeof require&&require;if(!n&&d)return d(i,!0);if(l)return l(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=a[i]={exports:{}};e[i][0].call(c.exports,function(t){var a=e[i][1][t];return r(a||t)},c,c.exports,t,e,a,s)}return a[i].exports}for(var l="function"==typeof require&&require,i=0;i<s.length;i++)r(s[i]);return r}({1:[function(t,e,a){d3.json("http://googlescript.startribune.com/?macro=AKfycbw_cqdXZADky_zHS3pi9aBL2S3-514vlxJkcnv5TJ1z9sxCqPY&id=1T-Du1geFfuspEYGF_U0531mLTJ0ehbA5YbaFCxgmkRA&sheet=mn_shootings",function(t,e){d3.json("http://googlescript.startribune.com/?macro=AKfycbw_cqdXZADky_zHS3pi9aBL2S3-514vlxJkcnv5TJ1z9sxCqPY&id=1T-Du1geFfuspEYGF_U0531mLTJ0ehbA5YbaFCxgmkRA&sheet=yearChart",function(t,a){d3.json("http://googlescript.startribune.com/?macro=AKfycbw_cqdXZADky_zHS3pi9aBL2S3-514vlxJkcnv5TJ1z9sxCqPY&id=1T-Du1geFfuspEYGF_U0531mLTJ0ehbA5YbaFCxgmkRA&sheet=raceChart",function(t,s){d3.json("http://googlescript.startribune.com/?macro=AKfycbw_cqdXZADky_zHS3pi9aBL2S3-514vlxJkcnv5TJ1z9sxCqPY&id=1T-Du1geFfuspEYGF_U0531mLTJ0ehbA5YbaFCxgmkRA&sheet=viz_chatter",function(t,r){dataShootings=e.mn_shootings,dataYear=a.yearChart,dataRace=s.raceChart,dataChatter=r.viz_chatter;var l=!1;$("#bigCount").html(dataShootings.length),$(".scrollToTop").click(function(){return $("#deathsTable").animate({scrollTop:0},800),!1}),$("#mainFilters").hide(),$(".switch").click(function(){$(".switch").removeClass("selected"),$(".bigswitch").removeClass("selected"),$("#mainFilters").show(),$("#clickyStuff").hide(),$(this).addClass("selected"),$("#filterWord").text($(this).attr("data")),$(".chartTitle, .chatter").hide(),$(".filterSection").hide(),$("."+$(this).attr("data")).show(),d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1)}),$(".bigswitch").click(function(){$(".bigswitch").removeClass("selected"),$(this).addClass("selected"),$(".switch").removeClass("selected"),$("#mainFilters").hide(),$("#clickyStuff").show()}),$("#bigNumber").html(dataShootings.length),$(".results").html(dataShootings.length),d3.select("#deathsTable").selectAll(".card").data(dataShootings).enter().append("div").attr("id",function(t){return t.doch}).attr("class","card").html(function(t){var e="",a="<span class='hideThis'>"+t.Mental+"</span>";return"Yes"==t.Mental&&(a="<span class='hideThis'>"+t.Mental+"</span><div class='mentalSwatch'>Mental health issues</div>"),"#"!=t.URL&&(e="<div class='url'><a href='"+t.URL+"' target='new_'>More coverage</a></div>"),"<div class='leftSide'><div class='name'>"+t.FirstName+" "+t.LastName+" "+t.Suffix+"</div><div class='stats'>"+t.AgeYears+" &#8226; "+t.Occupation+"</div><div class='description_chatter'>"+t.StribNarrative+"</div><div class='stats'>"+t.Race+" &#8226; "+t.Gender+" &#8226; "+t.ResCity+"</div><div class='location'>Incident: "+d3.time.format("%m-%d-%Y")(new Date(t.DeathDate))+" &#8226; Location: "+t.InjuryCity+" &#8226; Agency: "+t.Agency+"</div><div class='ruling'>Weapon: "+t.Weapon+" &#8226 Ruling: "+t.MannerDeath+"</div>"+a+"</div><div class='rightSide'><div class='photo'><img src='http://stmedia.stimg.co/"+t.photo+"?h=155&w=150&fit=crop&bg=999&crop=faces' /></div></div><div class='weaponType'>"+t.WeaponCategory+"</div><div class='region'>"+t.Region+"</div><div class='break'></div>"+e+"<div class='readmore'>Read more</div>"}),function(){$("#deathsTable .card").each(function(t,e){$(this).addClass("lightbox")}),$("#deathsTable .card.lightbox").each(function(t,e){$(this).attr("data-featherlight","#"+$(this).attr("id"))})}(),$(".card").on("click",function(){$(document).bind("DOMNodeInserted",function(t){$(".featherlight-content .card").removeClass("lightbox"),$(".featherlight-content .card").removeClass("featherlight-inner"),$(".featherlight-content .card").attr("data-featherlight","")})}),$(".url").on("click",function(){return window.open($(this).find("a").attr("href"),"_new"),!1}),$(".zoom").click(function(){$(".card").show();var t=$(".card:visible").length;if($(".results").html(t),$("#mainFilters").hide(),$(".dot").removeClass("faded, active"),d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),1==l){$(".bigswitch, .switch").removeClass("selected"),$("#mentalB_m, #mentalB").addClass("selected"),$(".dot").each(function(t,e){"Yes"==$(this).attr("mental")&&$(this).addClass("mentalSwatch")}),$("#filter_box").val(""),$(".card").hide();$(".hideThis").each(function(){-1!=$(this).text().toUpperCase().indexOf("Yes".toUpperCase())&&$(this).parent().parent().show()});var t=$(".card:visible").length;$(".results").html(t)}else $(".bigswitch, .switch").removeClass("selected"),$("#all_m, #all").addClass("selected"),d3.selectAll(".dot").classed("mentalSwatch",!0)}),d3.helper={},d3.helper.tooltip=function(t){return function(e){var a,s=d3.select("body").node();e.on("mouseover",function(e,r){d3.select("body").selectAll("div.tooltip").remove(),a=d3.select("body").append("div").attr("class","tooltip");var l=d3.mouse(s);a.style("left",l[0]-180+"px").style("top",l[1]-15+"px").style("position","absolute").style("z-index",1001);t(e,r)}).on("mousemove",function(e,r){var l=d3.mouse(s);a.style("left",l[0]-180+"px").style("top",l[1]-15+"px");var i=t(e,r)||"";a.html(i)}).on("mouseout",function(t,e){a.remove()})}};for(var i=2e3;i<=2018;i++)!function(t){d3.select("#y"+t).selectAll(".dot").data(dataShootings.filter(function(e){return e.year==t}).sort(function(t,e){return d3.ascending(t.Mental,e.Mental)})).enter().append("div").attr("class","dot").attr("first",function(t){return t.FirstName}).attr("last",function(t){return t.LastName}).attr("gender",function(t){return" "+t.Gender}).attr("age",function(t){return t.AgeYears}).attr("year",function(t){return t.year}).attr("race",function(t){return t.Race}).attr("city",function(t){return t.InjuryCity}).attr("occupation",function(t){return t.Occupation}).attr("manner",function(t){return t.MannerDeath}).attr("region",function(t){return t.Region}).attr("weapon",function(t){return t.WeaponCategory}).attr("mental",function(t){return t.Mental}).on("mousedown",function(t,e){$(".dot").removeClass("faded, active"),$(".dot").addClass("faded"),d3.select(this).classed("faded",!1),d3.select(this).classed("active",!0),$(".card").hide();var a=t.FirstName+" "+t.LastName;$(".card").each(function(){-1!=$(this).text().toUpperCase().indexOf(a.toUpperCase())&&$(this).show()});var s=$(".card:visible").length;$(".results").html(s)}).html(function(t){return""}).call(d3.helper.tooltip(function(t,e){var a="";return"Yes"==t.Mental&&(a="<div class='mentallabel' style='color:#999;font-weight:900;font-size:.8em;'>MENTAL HEALTH ISSUES</div>"),"<div class='name'>"+t.FirstName+" "+t.LastName+"</div>"+a}))}(i);$("#filter_box").keyup(function(t){if(1==l){$("#filter_box").attr("placeholder","Search list of mental health deaths by name, year or keyword"),$(".card").hide();var e=$("#filter_box").val();$(".card").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&-1!=$(this).text().toUpperCase().indexOf("Yes".toUpperCase())&&$(this).show()});var a=$(".card:visible").length;$(".results").html(a)}else{$("#filter_box").attr("placeholder","Search list of all deaths by name, year or keyword"),$(".card").hide();var e=$("#filter_box").val();$(".card").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).show()});var a=$(".card:visible").length;$(".results").html(a)}}),$.getJSON("shapefiles/counties.json",function(t){if($("#mainFilters .filter3 a, #mainFilters .filter2 a, #mainFilters .filter a").css("background","#fff"),$(".bigDot").on("click",function(){$(".bigDot").removeClass("selected"),$(this).addClass("selected")}),$(".filter, .filter2, .filter3").on("click",function(){$(".bigDot").removeClass("selected"),$(this).find(".bigDot").addClass("selected")}),$(".filter").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1);var t=$(this).attr("data");if($(".dot").each(function(e,a){1==l?"Yes"==$(this).attr("mental")&&("WHITE"==t?"HISPANIC"!=$(this).attr("race")&&"WHITE"!=$(this).attr("race")||$(this).addClass("mentalSwatch"):$(this).attr("gender")!=t&&$(this).attr("race")!=t&&$(this).attr("manner")!=t||$(this).addClass("mentalSwatch")):"WHITE"==t?"HISPANIC"!=$(this).attr("race")&&"WHITE"!=$(this).attr("race")||$(this).addClass("mentalSwatch"):$(this).attr("gender")!=t&&$(this).attr("race")!=t&&$(this).attr("manner")!=t||$(this).addClass("mentalSwatch")}),$("#filter_box").val(""),1==l){$(".card").hide();var e=$(this).attr("data"),a=$(this).attr("data");"WHITE"==e&&(a="HISPANIC"),$(".card .stats, .card .ruling").each(function(){-1==$(this).text().toUpperCase().indexOf(e.toUpperCase())&&-1==$(this).text().toUpperCase().indexOf(a.toUpperCase())||!$(this).parent().parent().find(".mentalSwatch").length||$(this).parent().parent().show()});var s=$(".card:visible").length;$(".results").html(s)}else{$(".card").hide();var e=$(this).attr("data"),a=$(this).attr("data");"WHITE"==e&&(a="HISPANIC"),$(".card .stats, .card .ruling").each(function(){-1==$(this).text().toUpperCase().indexOf(e.toUpperCase())&&-1==$(this).text().toUpperCase().indexOf(a.toUpperCase())||$(this).parent().parent().show()});var s=$(".card:visible").length;$(".results").html(s)}}),$(".filter2").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1);var t=$(this).attr("data");if($(".dot").each(function(e,a){1==l?"Yes"==$(this).attr("mental")&&$(this).attr("weapon")==t&&$(this).addClass("mentalSwatch"):$(this).attr("weapon")==t&&$(this).addClass("mentalSwatch")}),$("#filter_box").val(""),1==l){$(".card").hide();var e=$(this).attr("data");$(".weaponType").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).parent().find(".mentalSwatch").length&&$(this).parent().show()});var a=$(".card:visible").length;$(".results").html(a)}else{$(".card").hide();var e=$(this).attr("data");$(".weaponType").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).parent().show()});var a=$(".card:visible").length;$(".results").html(a)}}),$(".filter3").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1);var t=$(this).attr("data");if($(".dot").each(function(e,a){1==l?"Yes"==$(this).attr("mental")&&$(this).attr("region")==t&&$(this).addClass("mentalSwatch"):$(this).attr("region")==t&&$(this).addClass("mentalSwatch")}),$("#filter_box").val(""),1==l){$(".card").hide();var e=$(this).attr("data");$(".region").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).parent().find(".mentalSwatch").length&&$(this).parent().show()});var a=$(".card:visible").length;$(".results").html(a)}else{$(".card").hide();var e=$(this).attr("data");$(".region").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).parent().show()});var a=$(".card:visible").length;$(".results").html(a)}}),$.urlParam=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null!=e?e[1]:0},0!=$.urlParam("mental")){$.urlParam("mental");if("yes"){$("#filter_box").attr("placeholder","Search list of mental health deaths by name, year or keyword"),l=!0,d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1);for(var e=0;e<dataChatter.length;e++)"mental"==dataChatter[e].category&&$(".chatterThing").html(dataChatter[e].chatter);$(".bigswitch, .switch").removeClass("selected"),$("#mentalB_m, #mentalB").addClass("selected"),$(".chatter, .chartTitle").hide(),$(".mental").show(),$(".dot").each(function(t,e){"Yes"==$(this).attr("mental")&&$(this).addClass("mentalSwatch")}),$("#filter_box").val(""),$(".card").hide();$(".hideThis").each(function(){-1!=$(this).text().toUpperCase().indexOf("Yes".toUpperCase())&&$(this).parent().parent().show()});var a=$(".card:visible").length;$(".results").html(a)}}else{$(".bigswitch, .switch").removeClass("selected"),$("#all_m, #all").addClass("selected"),d3.selectAll(".dot").classed("mentalSwatch",!0);for(var e=0;e<dataChatter.length;e++)"all"==dataChatter[e].category&&$(".chatterThing").html(dataChatter[e].chatter)}$("#all, #all_m").on("click",function(){$("#filter_box").attr("placeholder","Search list of all deaths by name, year or keyword"),l=!1,$(".card").show();var t=$(".card:visible").length;$(".results").html(t),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!0),d3.selectAll(".dot").classed("faded",!1);for(var e=0;e<dataChatter.length;e++)"all"==dataChatter[e].category&&$(".chatterThing").html(dataChatter[e].chatter)}),$("#mentalB, #mentalB_m").on("click",function(){$("#filter_box").attr("placeholder","Search list of mental health deaths by name, year or keyword"),l=!0;for(var t=0;t<dataChatter.length;t++)"mental"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter);$(".bigDot").removeClass("selected"),$("#mentalDot").addClass("selected"),d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),$(".dot").each(function(t,e){"Yes"==$(this).attr("mental")&&$(this).addClass("mentalSwatch")}),$("#filter_box").val(""),$(".card").hide(),$(".hideThis").each(function(){-1!=$(this).text().toUpperCase().indexOf("Yes".toUpperCase())&&$(this).parent().parent().show()});var e=$(".card:visible").length;$(".results").html(e)}),$("#weaponB").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),$(".bigDot").removeClass("selected"),$("#weaponDot").addClass("selected"),$(".dot").each(function(t,e){if(1==l){if("GUN"==$(this).attr("weapon")&&"Yes"==$(this).attr("mental")){$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"weapon_mental"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}else{"GUN"==$(this).attr("weapon")&&$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"weapon_all"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}),$("#filter_box").val(""),$(".card").hide();var t="GUN";$(".weaponType").each(function(){1==l?-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().find(".mentalSwatch").length&&$(this).parent().show():-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().show()});var e=$(".card:visible").length;$(".results").html(e)}),$("#raceB").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),$(".bigDot").removeClass("selected"),$("#raceDot").addClass("selected"),$(".dot").each(function(t,e){if(1==l){if("BLACK"==$(this).attr("race")&&"Yes"==$(this).attr("mental")){$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"race_mental"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}else{"BLACK"==$(this).attr("race")&&$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"race_all"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}),$("#filter_box").val(""),$(".card").hide();var t="BLACK";$(".card .stats, .card .ruling").each(function(){1==l?-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().parent().find(".mentalSwatch").length&&$(this).parent().parent().show():-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().parent().show()});var e=$(".card:visible").length;$(".results").html(e)}),$("#placeB").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),$(".bigDot").removeClass("selected"),$("#placeDot").addClass("selected"),$(".dot").each(function(t,e){if(1==l){if("Metro"==$(this).attr("region")&&"Yes"==$(this).attr("mental")){$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"location_mental"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}else{"Metro"==$(this).attr("region")&&$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"location_all"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}),$("#filter_box").val(""),$(".card").hide();var t="Metro";$(".region").each(function(){1==l?-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().find(".mentalSwatch").length&&$(this).parent().show():-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().show()});var e=$(".card:visible").length;$(".results").html(e)}),$("#mannerB").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),$(".bigDot").removeClass("selected"),$("#mannerDot").addClass("selected"),$(".dot").each(function(t,e){if(1==l){if("HOMICIDE"==$(this).attr("manner")&&"Yes"==$(this).attr("mental")){$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"manner_mental"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}else{"HOMICIDE"==$(this).attr("manner")&&$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"manner_all"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}),$("#filter_box").val(""),$(".card").hide();var t="HOMICIDE";$(".card .stats, .card .ruling").each(function(){1==l?-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().parent().find(".mentalSwatch").length&&$(this).parent().parent().show():-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().parent().show()});var e=$(".card:visible").length;$(".results").html(e)}),$("#genderB").on("click",function(){d3.selectAll(".dot").classed("faded",!1),d3.selectAll(".dot").classed("active",!1),d3.selectAll(".dot").classed("mentalSwatch",!1),$(".bigDot").removeClass("selected"),$("#genderDot").addClass("selected"),$(".dot").each(function(t,e){if(1==l){if(" MALE"==$(this).attr("gender")&&"Yes"==$(this).attr("mental")){$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"gender_mental"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}else{" MALE"==$(this).attr("gender")&&$(this).addClass("mentalSwatch");for(var t=0;t<dataChatter.length;t++)"gender_all"==dataChatter[t].category&&$(".chatterThing").html(dataChatter[t].chatter)}}),$("#filter_box").val(""),$(".card").hide();var t=" MALE";$(".card .stats, .card .ruling").each(function(){1==l?-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().parent().find(".mentalSwatch").length&&$(this).parent().parent().show():-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).parent().parent().show()});var e=$(".card:visible").length;$(".results").html(e)})})})})})})},{}]},{},[1]);