!function e(t,r,a){function o(s,n){if(!r[s]){if(!t[s]){var d="function"==typeof require&&require;if(!n&&d)return d(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return o(r||e)},l,l.exports,e,t,r,a)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<a.length;s++)o(a[s]);return o}({1:[function(e,t,r){!function t(r,a,o){function i(n,d){if(!a[n]){if(!r[n]){var l="function"==typeof e&&e;if(!d&&l)return l(n,!0);if(s)return s(n,!0);throw new Error("Cannot find module '"+n+"'")}var c=a[n]={exports:{}};r[n][0].call(c.exports,function(e){var t=r[n][1][e];return i(t||e)},c,c.exports,t,r,a,o)}return a[n].exports}for(var s="function"==typeof e&&e,n=0;n<o.length;n++)i(o[n]);return i}({1:[function(e,t,r){function a(e){this.dd=e,this.placeholder=this.dd.children("span"),this.opts=this.dd.find("ul.dropdown > li"),this.val="",this.index=-1,this.initEvents()}d3.json("./data/markets.json",function(e,t){d3.json("./data/markets.geojson",function(e,r){var a=t.markets,o=r,i=[-93.265011,44.977753];!function(){d3.select("#table").selectAll(".card").data(a.sort(function(e,t){return d3.ascending(e.name,t.name)})).enter().append("div").attr("longitude",function(e){return e.longitude}).attr("latitude",function(e){return e.latitude}).attr("placeName",function(e){return e.name}).attr("pitch",function(e){return e.pitch}).attr("bearing",function(e){return e.bearing}).attr("class",function(e){var t="";return null!=e.monday&&""!=e.monday&&(t+="monday "),null!=e.tuesday&&""!=e.tuesday&&(t+="tuesday "),null!=e.wednesday&&""!=e.wednesday&&(t+="wednesday "),null!=e.thursday&&""!=e.thursday&&(t+="thursday "),null!=e.friday&&""!=e.friday&&(t+="friday "),null!=e.saturday&&""!=e.saturday&&(t+="saturday "),null!=e.sunday&&""!=e.sunday&&(t+="sunday "),"card "+t}).on("mousedown",function(e,t){$("#infobox #name, .pname").html(e.name),$("#infobox #address, .paddress").html(e.address+", "+e.city+", MN "+e.zip),$("#infobox #phone, .pphone").html(e.phone),$("#infobox #website, .pwebsite").html("<a href='"+e.website+"' target='new_'>Website</a>"),$("#infobox #area, .parea").html(e.where),$("#infobox #monday").html(e.monday),$("#infobox #tuesday").html(e.tuesday),$("#infobox #wednesday").html(e.wednesday),$("#infobox #thursday").html(e.thursday),$("#infobox #friday").html(e.friday),$("#infobox #saturday").html(e.saturday),$("#infobox #sunday").html(e.sunday),$("#infobox #notes").html(e.notes)}).html(function(e){return e.name}),$("#filter_box").on("keyup search",function(e){$(".check").addClass("toggle, selected"),$(".card").hide();var t=$("#filter_box").val();$(".card").each(function(){-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).show()})}),$(".card").click(function(){var e=Math.floor(4*Math.random())+1,t=$(this).attr("pitch")/e,r=$(this).attr("bearing")/e;s.flyTo({center:[$(this).attr("longitude"),$(this).attr("latitude")],zoom:14,pitch:t,bearing:r}),$(".card").removeClass("selected"),$(this).addClass("selected")}),$(".step").click(function(){$(".card").hide(),$("."+$(this).attr("data")).show(),s.flyTo({center:i,zoom:10,pitch:0,bearing:0}),$(".stat").html(""),$(".card").removeClass("selected")})}(),mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var s=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v10",center:i,zoom:4,minZoom:3});s.scrollZoom.disable(),s.on("load",function(){$(".mapboxgl-ctrl-geocoder input").attr("placeholder","Search by address"),s.addSource("dots",{type:"geojson",data:o}),s.addLayer({id:"dots-layer-monday",type:"circle",source:"dots",filter:["!=","monday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),s.addLayer({id:"dots-layer-tuesday",type:"circle",source:"dots",filter:["!=","tuesday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),s.addLayer({id:"dots-layer-wednesday",type:"circle",source:"dots",filter:["!=","wednesday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),s.addLayer({id:"dots-layer-thursday",type:"circle",source:"dots",filter:["!=","thursday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),s.addLayer({id:"dots-layer-friday",type:"circle",source:"dots",filter:["!=","friday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),s.addLayer({id:"dots-layer-saturday",type:"circle",source:"dots",filter:["!=","saturday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),s.addLayer({id:"dots-layer-sunday",type:"circle",source:"dots",filter:["!=","sunday",""],paint:{"circle-color":"rgba(194,42,34, 1)","circle-radius":5.5}}),$(".check").on("click",function(e){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected"),$(".card").hide(),$(".card").removeClass("selected"),$("#filter_box").val(""),s.setLayoutProperty("dots-layer-monday","visibility","none"),s.setLayoutProperty("dots-layer-tuesday","visibility","none"),s.setLayoutProperty("dots-layer-wednesday","visibility","none"),s.setLayoutProperty("dots-layer-thursday","visibility","none"),s.setLayoutProperty("dots-layer-friday","visibility","none"),s.setLayoutProperty("dots-layer-saturday","visibility","none"),s.setLayoutProperty("dots-layer-sunday","visibility","none"),s.flyTo({center:i,zoom:7,pitch:0,bearing:0}),$(".check.selected").each(function(){var e=$(this).attr("layer");console.log(e),$(".card").each(function(){$(this).hasClass(e)&&$(this).show()}),s.setLayoutProperty("dots-layer-"+e,"visibility","visible")})});var e=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});s.on("mousemove",function(t){var r=s.queryRenderedFeatures(t.point,{layers:["dots-layer-monday","dots-layer-tuesday","dots-layer-wednesday","dots-layer-thursday","dots-layer-friday","dots-layer-saturday","dots-layer-sunday"]});if(s.getCanvas().style.cursor=r.length?"pointer":"",!r.length)return void e.remove();var a=r[0];e.setLngLat(t.lngLat).setHTML(a.properties.name).addTo(s)}),$(".card").click(function(t){var r=s.queryRenderedFeatures(t.point,{layers:["dots-layer-monday","dots-layer-tuesday","dots-layer-wednesday","dots-layer-thursday","dots-layer-friday","dots-layer-saturday","dots-layer-sunday"]});if(s.getCanvas().style.cursor=r.length?"pointer":"",!r.length)return void e.remove();r[0];e.setLngLat([$(this).attr("longitude"),$(this).attr("latitude")]).setHTML($(this).attr("placeName")).addTo(s)}),$(".check").on("click",function(t){e.remove()});$(document).ready(function(){$("#wrapper").width()<920?s.flyTo({center:i,zoom:8,pitch:0,bearing:0}):s.flyTo({center:i,zoom:7}),$(window).resize(function(){$("#wrapper").width()<920?s.flyTo({center:i,zoom:8,pitch:0,bearing:0}):s.flyTo({center:i,zoom:7})})}),$(".zoom").click(function(){$(".check").addClass("toggle, selected"),s.flyTo({center:i,zoom:7,pitch:0,bearing:0}),$(".stat").html(""),$(".card").removeClass("selected"),$(".card").show(),$("#filter_box").val(""),e.remove(),s.setLayoutProperty("dots-layer-monday","visibility","visible"),s.setLayoutProperty("dots-layer-tuesday","visibility","visible"),s.setLayoutProperty("dots-layer-wednesday","visibility","visible"),s.setLayoutProperty("dots-layer-thursday","visibility","visible"),s.setLayoutProperty("dots-layer-friday","visibility","visible"),s.setLayoutProperty("dots-layer-saturday","visibility","visible"),s.setLayoutProperty("dots-layer-sunday","visibility","visible")})})})}),a.prototype={initEvents:function(){var e=this;e.dd.on("click",function(e){return $(this).toggleClass("active"),!1}),e.opts.on("click",function(){var t=$(this);e.val=t.text(),e.index=t.index(),e.placeholder.text(e.val)})},getValue:function(){return this.val},getIndex:function(){return this.index}},$(function(){new a($("#dd")),new a($("#ddY"));$(document).click(function(){$(".wrapper-dropdown-1").removeClass("active")})})},{}]},{},[1])},{}]},{},[1]);