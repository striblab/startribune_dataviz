!function e(t,i,a){function n(o,s){if(!i[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=i[o]={exports:{}};t[o][0].call(l.exports,function(e){var i=t[o][1][e];return n(i||e)},l,l.exports,e,t,i,a)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,i){$.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null!=t?t[1]||0:null};var a=$.urlParam("map");null!=a&&(a="embed"),"embed"==a&&($("#metrics").hide(),$("#listing").hide(),$("#filter").hide(),$(".mobilekill").show(),$("#key").hide()),d3.json("./shapefiles/mn_places.json",function(e,t){d3.json("./shapefiles/wi_places.json",function(e,i){d3.json("./shapefiles/mpls_nb.json",function(e,n){d3.json("./shapefiles/stp_nb.json",function(e,n){d3.json("./data/cities.json",function(e,n){function r(e,t,i,a,n){d3.select(e).selectAll(".row").sort(function(e,t){if("name"==a){if("descend"==n)return d3.descending(e.area,t.area);if("ascend"==n)return d3.ascending(e.area,t.area)}if("index"==a){if("descend"==n)return d3.descending(e.EffectiveNegEqRate,t.EffectiveNegEqRate);if("ascend"==n)return d3.ascending(e.EffectiveNegEqRate,t.EffectiveNegEqRate)}}).transition().duration(500)}function o(){f.flyTo({center:[-93.28469849,45.01832962],zoom:7.8,pitch:0,bearing:0}),$("#filter_box").val(""),$(".row").show(),$(".row").removeClass("selected"),$("#cities").animate({scrollTop:0},800),s("Willernie"),$(".row:contains('Willernie')").addClass("selected")}function s(e){var t=c.filter(function(t){return t.area==e});-1!=String(e).indexOf("(MPLS)")?$("#districtName").html(t[0].area+", Minneapolis, MN"):-1!=String(e).indexOf("(STP)")?$("#districtName").html(t[0].area+", St. Paul, MN"):$("#districtName").html(t[0].area);var i="#888888";t[0].EffectiveNegEqRate>=.27?i="#6a51a3":t[0].EffectiveNegEqRate>=.23?i="#807dba":t[0].EffectiveNegEqRate>=.17?i="#9e9ac8":t[0].EffectiveNegEqRate>=.12?i="#bcbddc":t[0].EffectiveNegEqRate>=0&&(i="#dadaeb"),$("#districtName").css("background-color",i),$("#indexRow").css("border","0 solid "+i),$("#days").html(t[0].starter2017),$("#distressed").html(t[0].tradeup2017),$("#ppsf").html(t[0].premium2017),$("#change").html(d3.format("+%")(t[0].percentchange)),0!=t[0].MedianHHincome?$("#income").html(d3.format("$,.0f")(t[0].MedianHHincome)):$("#income").html("N/A"),0!=t[0].PctSingleFamilyUnits?$("#homes").html(d3.format("%")(t[0].PctSingleFamilyUnits)):$("#homes").html("N/A"),0!=t[0].PctLargeApartmentBldgs?$("#apartments").html(d3.format("%")(t[0].PctLargeApartmentBldgs)):$("#apartments").html("N/A"),0!=t[0].PctKids?$("#kids").html(d3.format("%")(t[0].PctKids)):$("#kids").html("N/A"),0!=t[0].PctRenters?$("#renters").html(d3.format("%")(t[0].PctRenters)):$("#renters").html("N/A"),p.load({columns:[["x","2003-01-01","2004-01-01","2005-01-01","2006-01-01","2007-01-01","2008-01-01","2009-01-01","2010-01-01","2011-01-01","2012-01-01","2013-01-01","2014-01-01","2015-01-01","2016-01-01"],["PPSF",t[0].PPSF2003,t[0].PPSF2004,t[0].PPSF2005,t[0].PPSF2006,t[0].PPSF2007,t[0].PPSF2008,t[0].PPSF2009,t[0].PPSF2010,t[0].PPSF2011,t[0].PPSF2012,t[0].PPSF2013,t[0].PPSF2014,t[0].PPSF2015,t[0].PPSF2016]]})}var c=n.cities;d3.select("#cities").selectAll(".row").data(c.sort(function(e,t){return t.EffectiveNegEqRate-e.EffectiveNegEqRate})).enter().append("div").attr("class",function(e){return"Willernie"==e.area?"row selected":"row "}).style("background-color",function(e){var t="#888888";return e.EffectiveNegEqRate>=.27?t="#6a51a3":e.EffectiveNegEqRate>=.23?t="#807dba":e.EffectiveNegEqRate>=.17?t="#9e9ac8":e.EffectiveNegEqRate>=.12?t="#bcbddc":e.EffectiveNegEqRate>=0&&(t="#dadaeb"),t}).attr("latitude",function(e){return e.latitude}).attr("longitude",function(e){return e.longitude}).html(function(e,t){return"<div class='col name'>"+e.area+"</div><div class='col score'>"+d3.format("%")(e.EffectiveNegEqRate)+"</div>"}),$(document).ready(function(){$(".row").hide();var e=$("#filter_box").val();$(".row").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).show()}),$(".row").each(function(){-1==$(this).text().toUpperCase().indexOf("(MPLS)")&&-1==$(this).text().toUpperCase().indexOf("(STP)")||$(this).hide()}),$("#filter_box").on("keyup search",function(e){$(".row").hide();var t=$("#filter_box").val();$(".row").each(function(){-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).show()})}),$(".th").click(function(){if($(".th").removeClass("selected3"),$(this).addClass("selected3"),$(this).hasClass("toggled")){$(this).removeClass("toggled");var e="ascend"}else if($(this).hasClass("selected3")){$(this).addClass("toggled");var e="descend"}r("#cities",null,c,$(this).attr("data"),e)}),$(".row").click(function(){$(".row").removeClass("selected"),$(this).addClass("selected");var e=$(this).attr("longitude"),t=$(this).attr("latitude");-1!=$(this).find(".name").text().indexOf("(MPLS)")||-1!=$(this).find(".name").text().indexOf("(STP)")?f.flyTo({center:[e,t],zoom:13.5,pitch:0,bearing:0}):f.flyTo({center:[e,t],zoom:11.5,pitch:0,bearing:0}),s($(this).find(".name").text())})});var l=new mapboxgl.LngLat(-93.716125,44.643254),d=new mapboxgl.LngLat(-92.763062,45.350215);new mapboxgl.LngLatBounds(l,d);mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var f=new mapboxgl.Map({container:"map",style:"mapbox://styles/shadowflare/ciqznymjs0009btm891qyu49n",center:[-93.28469849,45.01832962],zoom:7.8,minZoom:7.8});f.addControl(new mapboxgl.NavigationControl),f.scrollZoom.disable(),f.on("load",function(){if($(".zoom").on("click",function(){o()}),f.addSource("mncities",{type:"geojson",data:t}),f.addSource("wicities",{type:"geojson",data:i}),f.addLayer({id:"mncities-layer",interactive:!0,source:"mncities",filter:["!=","index_EffectiveNegEqRate",0],layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.8,"fill-color":{property:"index_EffectiveNegEqRate",type:"interval",stops:[[0,"rgba(255, 255, 255, 0)"],[.01,"#dadaeb"],[.12,"#bcbddc"],[.17,"#9e9ac8"],[.23,"#807dba"],[.27,"#6a51a3"]]},"fill-outline-color":"rgba(255, 255, 255, 0.1)"}},"place-neighbourhood"),f.addLayer({id:"wicities-layer",interactive:!0,source:"wicities",filter:["!=","index_EffectiveNegEqRate",0],layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.8,"fill-color":{property:"index_EffectiveNegEqRate",type:"interval",stops:[[0,"rgba(255, 255, 255, 0)"],[.01,"#dadaeb"],[.12,"#bcbddc"],[.17,"#9e9ac8"],[.23,"#807dba"],[.27,"#6a51a3"]]},"fill-outline-color":"rgba(255, 255, 255, 0.1)"}},"place-neighbourhood"),"embed"==a){var e=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});f.on("mousemove",function(t){var i=f.queryRenderedFeatures(t.point,{layers:["wicities-layer","mncities-layer"]});if(f.getCanvas().style.cursor=i.length?"pointer":"",!i.length)return void e.remove();var a=i[0];e.setLngLat(t.lngLat).setHTML("<h4>"+a.properties.NAME+"</h4>"+d3.format("%")(a.properties.index_EffectiveNegEqRate)).addTo(f)})}});var m=c.filter(function(e){return"Minneapolis"==e.name}),u={top:40,right:40,bottom:30,left:40},p=c3.generate({bindto:"#chart",padding:u,data:{x:"x",columns:[["x","2003-01-01","2004-01-01","2005-01-01","2006-01-01","2007-01-01","2008-01-01","2009-01-01","2010-01-01","2011-01-01","2012-01-01","2013-01-01","2014-01-01","2015-01-01","2016-01-01"],["PPSF",m[0].PPSF2003,m[0].PPSF2004,m[0].PPSF2005,m[0].PPSF2006,m[0].PPSF2007,m[0].PPSF2008,m[0].PPSF2009,m[0].PPSF2010,m[0].PPSF2011,m[0].PPSF2012,m[0].PPSF2013,m[0].PPSF2014,m[0].PPSF2015,m[0].PPSF2016]],names:{PPSF:"Price per sq. ft."},colors:{PPSF:"#333333"}},point:{show:!1},legend:{show:!1},axis:{y:{max:400,min:0,padding:{bottom:0,top:0},tick:{values:[100,250,400],count:4,format:d3.format("$.0f")}},x:{type:"timeseries",tick:{format:"%Y"}}}});d3.select("#chart svg").append("text").attr("x",50).attr("y",50).style("text-anchor","right").text("Price per square foot over time"),s("Willernie")})})})})})},{}]},{},[1]);