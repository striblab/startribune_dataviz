!function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){var i=e[a][1][t];return o(i||t)},l,l.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){$.urlParam=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null!=e?e[1]||0:null};var n=$.urlParam("chart");null!=n&&($(".slide").hide(),$("#"+n).show()),"lookup"==n?($("#districtSelect").click(function(){$("#listedSchools, #filter").slideToggle(),$(".directions").toggle()}),$("#filter input").on("keyup search",function(t){$(".district").hide();var e=$("#filter input").val();$(".district").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).show()})}),d3.json("./data/districts.json",function(t,e){function i(t,e){var i=n.sort(function(t,e){return d3.ascending(t.datayear,e.datayear)}),o=1;if("base"==e)for(var r=0;r<i.length;r++)if(t==i[r].HomeDistName)return i[r].county+" County ("+i[r].location+")";if("axis"==e){var a=[];a[0]="x";for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(a[o]=i[r].datayear,o++);return a}if("incoming"==e){var s=[];s[0]="Incoming";for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(s[o]=i[r].PctComingIn,o++);return s}if("leavingCharter"==e){var c=[];c[0]="Charters";for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(c[o]=i[r].PctLeavingToCharter,o++);return c}if("leavingOpen"==e){var l=[];l[0]="Open Enrollment";for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(l[o]=i[r].PctLeavingOpenEnroll,o++);return l}if("enrolled"==e){var u=[];u[0]="Enrolled";for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(u[o]=i[r].totalenroll,o++);return u}if("residents"==e){var m=[];m[0]="Residents";for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(m[o]=i[r].residents,o++);return m}if("whiteleave"==e){for(var d=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(d=n[r].WhtLeaving/(n[r].WhtLeaving+n[r].AmIndLeaving+n[r].BlkLeaving+n[r].AsnLeaving+n[r].HispLeaving));return d}if("whiteres"==e){for(var f=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(f=n[r].WhtResidents/n[r].residents);return f}if("blackleave"==e){for(var h=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(h=n[r].BlkLeaving/(n[r].WhtLeaving+n[r].AmIndLeaving+n[r].BlkLeaving+n[r].AsnLeaving+n[r].HispLeaving));return h}if("blackres"==e){for(var g=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(g=n[r].BlkResidents/n[r].residents);return g}if("nativeleave"==e){for(var v=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(v=n[r].AmIndLeaving/(n[r].WhtLeaving+n[r].AmIndLeaving+n[r].BlkLeaving+n[r].AsnLeaving+n[r].HispLeaving));return v}if("nativeres"==e){for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(g=n[r].AmIndResidents/n[r].residents);return 0}if("asianleave"==e){for(var p=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(p=n[r].AsnLeaving/(n[r].WhtLeaving+n[r].AmIndLeaving+n[r].BlkLeaving+n[r].AsnLeaving+n[r].HispLeaving));return p}if("asianres"==e){for(var r=0;r<i.length;r++)t==i[r].HomeDistName&&(g=n[r].AsnResidents/n[r].residents);return 0}if("hispanicleave"==e){for(var y=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(y=n[r].HispLeaving/(n[r].WhtLeaving+n[r].AmIndLeaving+n[r].BlkLeaving+n[r].AsnLeaving+n[r].HispLeaving));return y}if("hispanicres"==e){for(var x=0,r=0;r<i.length;r++)t==i[r].HomeDistName&&(x=n[r].HispResidents/n[r].residents);return x}}var n=e.districts;d3.select("#listedSchools").selectAll(".district").data(n.sort(function(t,e){return d3.ascending(t.HomeDistName,e.HomeDistName)}).filter(function(t){return"2016"==t.datayear&&"Statewide"!=t.HomeDistName})).enter().append("li").attr("class",function(t){return"district"}).on("click",function(t){$("#county").html(i(t.HomeDistName,"base"))}).html(function(t){return t.HomeDistName}),$("li.district").click(function(){$("li.district").removeClass("selected"),$(this).addClass("selected"),$("#listedSchools, #filter").slideToggle(),$("#thisDistrict").html($(this).text()),$(".directions").toggle(),s.load({columns:[i($(this).text(),"axis"),i($(this).text(),"leavingCharter"),i($(this).text(),"leavingOpen")]}),c.load({columns:[["Leaving District",i($(this).text(),"whiteleave"),i($(this).text(),"blackleave"),i($(this).text(),"asianleave"),i($(this).text(),"nativeleave"),i($(this).text(),"hispanicleave")],["Residents",i($(this).text(),"whiteres"),i($(this).text(),"blackres"),i($(this).text(),"asianres"),i($(this).text(),"nativeres"),i($(this).text(),"hispanicres")]]}),l.load({columns:[i($(this).text(),"axis"),i($(this).text(),"incoming")]}),u.load({columns:[i($(this).text(),"axis"),i($(this).text(),"enrolled"),i($(this).text(),"residents")]})});var o="Minneapolis Public School District",r={top:20,right:60,bottom:20,left:60},a=i(o,"axis"),s=c3.generate({bindto:"#leavingChart",padding:r,data:{x:"x",columns:[a,i(o,"leavingCharter"),i(o,"leavingOpen")],type:"area",groups:[["Charters","Open Enrollment"]],labels:{}},bar:{width:{ratio:.2}},transition:{duration:1300},legend:{show:!1},point:{show:!1},color:{pattern:["#a3858b","#4c1926"]},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:4,values:[0,.25,.5,.75,1],format:d3.format("%")}},x:{padding:{bottom:0,top:0,right:0,left:0},tick:{count:4,values:[a[1],2006,2012,a[a.length-1]]}}},grid:{}}),c=c3.generate({bindto:"#raceChart",padding:r,data:{columns:[["Leaving District",i(o,"whiteleave"),i(o,"blackleave"),i(o,"asianleave"),i(o,"nativeleave"),i(o,"hispanicleave")],["Residents",i(o,"whiteres"),i(o,"blackres"),i(o,"asianres"),i(o,"nativeres"),i(o,"hispanicres")]],type:"bar",labels:{}},legend:{show:!1},transition:{duration:1300},color:{pattern:["#865f67","#333333"]},point:{show:!1},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:4,values:[0,.25,.5,.75,1],format:d3.format("%.0f")}},x:{type:"category",categories:["White","Black","Asian","Native","Hisp."],padding:{bottom:0,top:0,right:0,left:0},tick:{rotate:-75,multiline:!1},height:30}},grid:{}}),l=c3.generate({bindto:"#incomingChart",padding:r,data:{x:"x",columns:[i(o,"axis"),i(o,"incoming")],type:"area",labels:{}},legend:{show:!1},transition:{duration:1300},point:{show:!1},color:{pattern:["#865f67"]},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:4,values:[0,.25,.5,.75,1],format:d3.format("%")}},x:{padding:{bottom:0,top:0,right:0,left:0},tick:{count:4,values:[a[1],2006,2012,a[a.length-1]]}}},grid:{}}),u=c3.generate({bindto:"#enrollmentChart",padding:r,data:{x:"x",columns:[a,i(o,"enrolled"),i(o,"residents")],type:"line",labels:{}},legend:{show:!1},transition:{duration:1300},color:{pattern:["#693c46","#333333"]},point:{show:!1},axis:{y:{min:0,padding:{bottom:0,top:0},tick:{count:4,format:d3.format(",.0f")}},x:{padding:{bottom:0,top:0,right:0,left:0},tick:{count:4,values:[a[1],2006,2012,a[a.length-1]]}}},grid:{}});$(".switch").first().addClass("selected")})):"charter"==n&&d3.json("./data/charters.geojson",function(t,e){mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var i=new mapboxgl.Map({container:"map",style:"mapbox://styles/shadowflare/ciqzo0bu20004bknkbrhrm6wf",center:[-94.6859,46.729553],zoom:5,minZoom:2});i.addControl(new mapboxgl.NavigationControl),i.scrollZoom.disable(),i.on("load",function(){function t(t,e,n){cap=t;i.addLayer({id:"charter-layer-"+t,type:"circle",source:"charters",paint:{"circle-radius":5,"circle-radius-transition":{duration:0},"circle-opacity-transition":{duration:0},"circle-color":"rgba("+e+", 0.45)"},filter:["==","firstyr",t]}),i.addLayer({id:"charter-layer1-"+t,type:"circle",source:"charters",paint:{"circle-radius":5,"circle-radius-transition":{duration:0},"circle-opacity-transition":{duration:0},"circle-color":"rgba(204, 0, 0, 0.45)"},filter:["==","lastyr",t]}),i.setLayoutProperty("charter-layer1-"+t,"visibility","none"),i.setLayoutProperty("charter-layer-"+t,"visibility","none");var o=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});i.on("mousemove",function(e){var n=i.queryRenderedFeatures(e.point,{layers:["charter-layer-"+t,"charter-layer-1"+t]});if(i.getCanvas().style.cursor=n.length?"pointer":"",!n.length)return void o.remove();n[0]})}function n(t){i.setLayoutProperty("charter-layer1-"+t,"visibility","visible"),i.setLayoutProperty("charter-layer-"+t,"visibility","visible")}function o(t,e){for(var n=t;n<=e;n++)i.setLayoutProperty("charter-layer1-"+n,"visibility","none"),i.setLayoutProperty("charter-layer-"+n,"visibility","none")}$("#state").click(function(){$(".switch").removeClass("selected"),$(this).addClass("selected"),i.flyTo({center:[-94.6859,46.729553],zoom:5})}),$("#metro").click(function(){$(".switch").removeClass("selected"),$(this).addClass("selected"),i.flyTo({center:[-93.265011,44.977753],zoom:10})}),i.addSource("charters",{type:"geojson",data:e}),function(){for(var e=1995;e<=2017;e++)t(e,"51,204,255",e)}(),o(1995,2017);var r=[];r[0]=setTimeout(function(){n(1995)},1e3),r[1]=setTimeout(function(){n(1996)},1400),r[2]=setTimeout(function(){n(1997)},1800),r[3]=setTimeout(function(){n(1998)},2200),r[4]=setTimeout(function(){n(1999)},2600),r[5]=setTimeout(function(){n(2e3)},3200),r[6]=setTimeout(function(){n(2001)},3800),r[7]=setTimeout(function(){n(2002)},4400),r[8]=setTimeout(function(){n(2003)},5e3),r[9]=setTimeout(function(){n(2004)},5600),r[10]=setTimeout(function(){n(2005)},7200),r[11]=setTimeout(function(){n(2006)},7800),r[12]=setTimeout(function(){n(2007)},8200),r[13]=setTimeout(function(){n(2008)},8600),r[14]=setTimeout(function(){n(2009)},9e3),r[15]=setTimeout(function(){n(2010)},9400),r[16]=setTimeout(function(){n(2011)},9800),r[17]=setTimeout(function(){n(2012)},10200),r[18]=setTimeout(function(){n(2013)},10600),r[19]=setTimeout(function(){n(2014)},11e3),r[20]=setTimeout(function(){n(2015)},11400),r[21]=setTimeout(function(){n(2016)},11800),r[22]=setTimeout(function(){n(2016)},12200),$("#reload").click(function(){o(1995,2017);for(var t=0;t<r.length;t++)clearTimeout(r[t]);r[0]=setTimeout(function(){n(1995)},1e3),r[1]=setTimeout(function(){n(1996)},1400),r[2]=setTimeout(function(){n(1997)},1800),r[3]=setTimeout(function(){n(1998)},2200),r[4]=setTimeout(function(){n(1999)},2600),r[5]=setTimeout(function(){n(2e3)},3200),r[6]=setTimeout(function(){n(2001)},3800),r[7]=setTimeout(function(){n(2002)},4400),r[8]=setTimeout(function(){n(2003)},5e3),r[9]=setTimeout(function(){n(2004)},5600),r[10]=setTimeout(function(){n(2005)},7200),r[11]=setTimeout(function(){n(2006)},7800),r[12]=setTimeout(function(){n(2007)},8200),r[13]=setTimeout(function(){n(2008)},8600),r[14]=setTimeout(function(){n(2009)},9e3),r[15]=setTimeout(function(){n(2010)},9400),r[16]=setTimeout(function(){n(2011)},9800),r[17]=setTimeout(function(){n(2012)},10200),r[18]=setTimeout(function(){n(2013)},10600),r[19]=setTimeout(function(){n(2014)},11e3),r[20]=setTimeout(function(){n(2015)},11400),r[21]=setTimeout(function(){n(2016)},11800),r[22]=setTimeout(function(){n(2016)},12200)})})})},{}]},{},[1]);