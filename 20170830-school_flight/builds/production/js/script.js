!function t(e,i,n){function a(r,s){if(!i[r]){if(!e[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=i[r]={exports:{}};e[r][0].call(l.exports,function(t){var i=e[r][1][t];return a(i||t)},l,l.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(t,e,i){$.urlParam=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null!=e?e[1]||0:null};var n=$.urlParam("chart");null!=n&&($(".slide").hide(),$("#"+n).show()),"lookup"==n?($("#districtSelect").click(function(){$("#listedSchools, #filter").slideToggle(),$(".directions").toggle()}),$("#filter input").on("keyup search",function(t){$(".district").hide();var e=$("#filter input").val();$(".district").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).show()})}),d3.json("./data/districts.json",function(t,e){function i(t,e){var i=n.sort(function(t,e){return d3.ascending(t.datayear,e.datayear)}),a=1;if("base"==e)for(var o=0;o<i.length;o++)if(t==i[o].HomeDistName)return i[o].county+" County ("+i[o].location+")";if("axis"==e){var r=[];r[0]="x";for(var o=0;o<i.length;o++)t==i[o].HomeDistName&&(r[a]=i[o].datayear,a++);return r}if("incoming"==e){var s=[];s[0]="Incoming";for(var o=0;o<i.length;o++)t==i[o].HomeDistName&&(s[a]=i[o].PctComingIn,a++);return s}if("leavingCharter"==e){var c=[];c[0]="Charters";for(var o=0;o<i.length;o++)t==i[o].HomeDistName&&(c[a]=i[o].PctLeavingToCharter,a++);return c}if("leavingOpen"==e){var l=[];l[0]="Open Enrollment";for(var o=0;o<i.length;o++)t==i[o].HomeDistName&&(l[a]=i[o].PctLeavingOpenEnroll,a++);return l}if("enrolled"==e){var u=[];u[0]="Enrolled";for(var o=0;o<i.length;o++)t==i[o].HomeDistName&&(u[a]=i[o].totalenroll,a++);return u}if("residents"==e){var d=[];d[0]="Residents";for(var o=0;o<i.length;o++)t==i[o].HomeDistName&&(d[a]=i[o].residents,a++);return d}if("whiteleave"==e){for(var m=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(m=n[o].WhtLeaving/(n[o].WhtLeaving+n[o].AmIndLeaving+n[o].BlkLeaving+n[o].AsnLeaving+n[o].HispLeaving));return m}if("whiteres"==e){for(var f=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(f=n[o].WhtResidents/n[o].residents);return f}if("blackleave"==e){for(var h=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(h=n[o].BlkLeaving/(n[o].WhtLeaving+n[o].AmIndLeaving+n[o].BlkLeaving+n[o].AsnLeaving+n[o].HispLeaving));return h}if("blackres"==e){for(var g=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(g=n[o].BlkResidents/n[o].residents);return g}if("nativeleave"==e){for(var v=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(v=n[o].AmIndLeaving/(n[o].WhtLeaving+n[o].AmIndLeaving+n[o].BlkLeaving+n[o].AsnLeaving+n[o].HispLeaving));return v}if("nativeres"==e){for(var p=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(p=n[o].AmIndResidents/n[o].residents);return p}if("asianleave"==e){for(var y=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(y=n[o].AsnLeaving/(n[o].WhtLeaving+n[o].AmIndLeaving+n[o].BlkLeaving+n[o].AsnLeaving+n[o].HispLeaving));return y}if("asianres"==e){for(var x=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(x=n[o].AsnResidents/n[o].residents);return x}if("hispanicleave"==e){for(var T=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(T=n[o].HispLeaving/(n[o].WhtLeaving+n[o].AmIndLeaving+n[o].BlkLeaving+n[o].AsnLeaving+n[o].HispLeaving));return T}if("hispanicres"==e){for(var b=0,o=0;o<i.length;o++)t==i[o].HomeDistName&&2017==i[o].datayear&&(b=n[o].HispResidents/n[o].residents);return b}}var n=e.districts;d3.select("#listedSchools").selectAll(".district").data(n.sort(function(t,e){return d3.ascending(t.HomeDistName,e.HomeDistName)}).filter(function(t){return"2016"==t.datayear&&"Statewide"!=t.HomeDistName})).enter().append("li").attr("class",function(t){return"district"}).on("click",function(t){$("#county").html(i(t.HomeDistName,"base"))}).html(function(t){return t.HomeDistName}),$("li.district").click(function(){$("li.district").removeClass("selected"),$(this).addClass("selected"),$("#listedSchools, #filter").slideToggle(),$("#thisDistrict").html($(this).text()),$(".directions").toggle(),s.load({columns:[i($(this).text(),"axis"),i($(this).text(),"leavingCharter"),i($(this).text(),"leavingOpen")]}),c.load({columns:[["Leaving District",i($(this).text(),"whiteleave"),i($(this).text(),"blackleave"),i($(this).text(),"asianleave"),i($(this).text(),"nativeleave"),i($(this).text(),"hispanicleave")],["Residents",i($(this).text(),"whiteres"),i($(this).text(),"blackres"),i($(this).text(),"asianres"),i($(this).text(),"nativeres"),i($(this).text(),"hispanicres")]]}),l.load({columns:[i($(this).text(),"axis"),i($(this).text(),"incoming")]}),u.load({columns:[i($(this).text(),"axis"),i($(this).text(),"enrolled"),i($(this).text(),"residents")]})});var a="Minneapolis Public School District",o={top:20,right:45,bottom:20,left:45},r=i(a,"axis"),s=c3.generate({bindto:"#leavingChart",padding:o,data:{x:"x",columns:[r,i(a,"leavingCharter"),i(a,"leavingOpen")],type:"area",groups:[["Charters","Open Enrollment"]],labels:{}},bar:{width:{ratio:.2}},transition:{duration:1300},legend:{show:!1},point:{show:!1},color:{pattern:["#b2cba2","#a5c3d2"]},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:4,values:[0,.25,.5,.75,1],format:d3.format("%")}},x:{padding:{bottom:0,top:0,right:0,left:0},tick:{count:4,values:[r[1],2006,2012,r[r.length-1]]}}},grid:{}}),c=c3.generate({bindto:"#raceChart",padding:o,data:{columns:[["Leaving District",i(a,"whiteleave"),i(a,"blackleave"),i(a,"asianleave"),i(a,"nativeleave"),i(a,"hispanicleave")],["Residents",i(a,"whiteres"),i(a,"blackres"),i(a,"asianres"),i(a,"nativeres"),i(a,"hispanicres")]],type:"bar",labels:{}},bar:{width:{ratio:.8}},legend:{show:!1},transition:{duration:1300},color:{pattern:["#b2cba2","#a5c3d2"]},point:{show:!1},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:4,values:[0,.25,.5,.75,1],format:d3.format("%.0f")}},x:{type:"category",categories:["White","Black","Asian","Native","Hisp."],padding:{bottom:0,top:0,right:0,left:0},tick:{rotate:-75,multiline:!1},height:30}},grid:{}}),l=c3.generate({bindto:"#incomingChart",padding:o,data:{x:"x",columns:[i(a,"axis"),i(a,"incoming")],type:"area",labels:{}},legend:{show:!1},transition:{duration:1300},point:{show:!1},color:{pattern:["#b2cba2"]},axis:{y:{max:1,min:0,padding:{bottom:0,top:0},tick:{count:4,values:[0,.25,.5,.75,1],format:d3.format("%")}},x:{padding:{bottom:0,top:0,right:0,left:0},tick:{count:4,values:[r[1],2006,2012,r[r.length-1]]}}},grid:{}}),u=c3.generate({bindto:"#enrollmentChart",padding:o,data:{x:"x",columns:[r,i(a,"enrolled"),i(a,"residents")],type:"line",labels:{}},legend:{show:!1},transition:{duration:1300},color:{pattern:["#7c9979","#7c94a0"]},point:{show:!1},axis:{y:{min:0,padding:{bottom:0,top:0},tick:{count:4,format:d3.format(",.0f")}},x:{padding:{bottom:0,top:0,right:0,left:0},tick:{count:4,values:[r[1],2006,2012,r[r.length-1]]}}},grid:{}});$(".switch").first().addClass("selected")})):"charter"==n&&d3.json("./data/charters.geojson",function(t,e){mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var i=new mapboxgl.Map({container:"map",style:"mapbox://styles/shadowflare/ciqzo0bu20004bknkbrhrm6wf",center:[-94.6859,46.729553],zoom:5,minZoom:2});i.addControl(new mapboxgl.NavigationControl),i.scrollZoom.disable(),i.on("load",function(){function t(t,e,n){cap=t;i.addLayer({id:"charter-layer-"+t,type:"circle",source:"charters",paint:{"circle-radius":5,"circle-radius-transition":{duration:0},"circle-opacity-transition":{duration:0},"circle-color":"rgba("+e+", 0.45)"},filter:["==","firstyr",t]}),i.addLayer({id:"charter-layer1-"+t,type:"circle",source:"charters",paint:{"circle-radius":5,"circle-radius-transition":{duration:0},"circle-opacity-transition":{duration:0},"circle-color":"rgba(204, 0, 0, 0.45)"},filter:["==","lastyr",t]}),i.setLayoutProperty("charter-layer1-"+t,"visibility","none"),i.setLayoutProperty("charter-layer-"+t,"visibility","none");var a=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});i.on("mousemove",function(e){var n=i.queryRenderedFeatures(e.point,{layers:["charter-layer-"+t,"charter-layer-1"+t]});if(i.getCanvas().style.cursor=n.length?"pointer":"",!n.length)return void a.remove();n[0]})}function n(t){i.setLayoutProperty("charter-layer1-"+t,"visibility","visible"),i.setLayoutProperty("charter-layer-"+t,"visibility","visible")}function a(t,e){for(var n=t;n<=e;n++)i.setLayoutProperty("charter-layer1-"+n,"visibility","none"),i.setLayoutProperty("charter-layer-"+n,"visibility","none")}$("#state").click(function(){$(".switch").removeClass("selected"),$(this).addClass("selected"),i.flyTo({center:[-94.6859,46.729553],zoom:5})}),$("#metro").click(function(){$(".switch").removeClass("selected"),$(this).addClass("selected"),i.flyTo({center:[-93.265011,44.977753],zoom:10})}),i.addSource("charters",{type:"geojson",data:e}),function(){for(var e=1995;e<=2017;e++)t(e,"51,204,255",e)}(),a(1995,2017);var o=[];o[0]=setTimeout(function(){n(1995)},1e3),o[1]=setTimeout(function(){n(1996)},1400),o[2]=setTimeout(function(){n(1997)},1800),o[3]=setTimeout(function(){n(1998)},2200),o[4]=setTimeout(function(){n(1999)},2600),o[5]=setTimeout(function(){n(2e3)},3200),o[6]=setTimeout(function(){n(2001)},3800),o[7]=setTimeout(function(){n(2002)},4400),o[8]=setTimeout(function(){n(2003)},5e3),o[9]=setTimeout(function(){n(2004)},5600),o[10]=setTimeout(function(){n(2005)},7200),o[11]=setTimeout(function(){n(2006)},7800),o[12]=setTimeout(function(){n(2007)},8200),o[13]=setTimeout(function(){n(2008)},8600),o[14]=setTimeout(function(){n(2009)},9e3),o[15]=setTimeout(function(){n(2010)},9400),o[16]=setTimeout(function(){n(2011)},9800),o[17]=setTimeout(function(){n(2012)},10200),o[18]=setTimeout(function(){n(2013)},10600),o[19]=setTimeout(function(){n(2014)},11e3),o[20]=setTimeout(function(){n(2015)},11400),o[21]=setTimeout(function(){n(2016)},11800),o[22]=setTimeout(function(){n(2016)},12200),$("#reload").click(function(){a(1995,2017);for(var t=0;t<o.length;t++)clearTimeout(o[t]);o[0]=setTimeout(function(){n(1995)},1e3),o[1]=setTimeout(function(){n(1996)},1400),o[2]=setTimeout(function(){n(1997)},1800),o[3]=setTimeout(function(){n(1998)},2200),o[4]=setTimeout(function(){n(1999)},2600),o[5]=setTimeout(function(){n(2e3)},3200),o[6]=setTimeout(function(){n(2001)},3800),o[7]=setTimeout(function(){n(2002)},4400),o[8]=setTimeout(function(){n(2003)},5e3),o[9]=setTimeout(function(){n(2004)},5600),o[10]=setTimeout(function(){n(2005)},7200),o[11]=setTimeout(function(){n(2006)},7800),o[12]=setTimeout(function(){n(2007)},8200),o[13]=setTimeout(function(){n(2008)},8600),o[14]=setTimeout(function(){n(2009)},9e3),o[15]=setTimeout(function(){n(2010)},9400),o[16]=setTimeout(function(){n(2011)},9800),o[17]=setTimeout(function(){n(2012)},10200),o[18]=setTimeout(function(){n(2013)},10600),o[19]=setTimeout(function(){n(2014)},11e3),o[20]=setTimeout(function(){n(2015)},11400),o[21]=setTimeout(function(){n(2016)},11800),o[22]=setTimeout(function(){n(2016)},12200)})})})},{}]},{},[1]);