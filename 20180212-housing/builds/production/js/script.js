!function e(t,i,n){function a(r,o){if(!i[r]){if(!t[r]){var d="function"==typeof require&&require;if(!o&&d)return d(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+r+"'")}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return a(i||e)},c,c.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(e,t,i){$.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null!=t?t[1]||0:null};var n=$.urlParam("chart");"all"==n?$(".slide").show():null!=n&&($(".slide").hide(),$("#"+n).show()),d3.json("./shapefiles/mn_places.json",function(e,t){d3.json("./shapefiles/wi_places.json",function(e,i){d3.json("./shapefiles/mpls_nb.json",function(e,n){d3.json("./shapefiles/stp_nb.json",function(e,a){d3.json("./data/cities.json",function(e,s){function r(e,t,i,n,a){d3.select(e).selectAll(".row").sort(function(e,t){if("name"==n){if("descend"==a)return d3.descending(e.name,t.name);if("ascend"==a)return d3.ascending(e.name,t.name)}if("index"==n){if("descend"==a)return d3.descending(e.IndexScore,t.IndexScore);if("ascend"==a)return d3.ascending(e.IndexScore,t.IndexScore)}}).transition().duration(500)}function o(){m.jumpTo({center:[-93.28469849,45.01832962],zoom:7.8,pitch:0,bearing:0}),$("#filter_box").val(""),$(".row").show()}function d(e){var t=l.filter(function(t){return t.name==e});-1!=String(e).indexOf("(MPLS)")?$("#districtName").html(t[0].CityState+", Minneapolis, MN"):-1!=String(e).indexOf("(STP)")?$("#districtName").html(t[0].CityState+", St. Paul, MN"):$("#districtName").html(t[0].CityState);t[0].IndexScore>=300||(t[0].IndexScore>=240||(t[0].IndexScore>=180||(t[0].IndexScore>=120||t[0].IndexScore))),$("#days").html(t[0].DaysMarket),$("#daysC").html(t[0].diff),$("#change").html(d3.format("+%")(t[0].PctChgfromAvg)),$("#distressed").html(d3.format("%")(t[0].PctDistressed)),$("#ppsf").html(d3.format("%")(t[0].PctOrigPrice)),P.load({columns:[["x","2003-01-01","2004-01-01","2005-01-01","2006-01-01","2007-01-01","2008-01-01","2009-01-01","2010-01-01","2011-01-01","2012-01-01","2013-01-01","2014-01-01","2015-01-01","2016-01-01","2017-01-01"],["PPSF",t[0].PPSF2003,t[0].PPSF2004,t[0].PPSF2005,t[0].PPSF2006,t[0].PPSF2007,t[0].PPSF2008,t[0].PPSF2009,t[0].PPSF2010,t[0].PPSF2011,t[0].PPSF2012,t[0].PPSF2013,t[0].PPSF2014,t[0].PPSF2015,t[0].PPSF2016,t[0].PPSF2017]]})}function c(e,t,i,n){d3.select(e).selectAll(".listrow").sort(function(e,t){if("name"==i){if("descend"==n)return d3.descending(e.name,t.name);if("ascend"==n)return d3.ascending(e.name,t.name)}if("index"==i){if("descend"==n)return d3.descending(e.IndexScore,t.IndexScore);if("ascend"==n)return d3.ascending(e.IndexScore,t.IndexScore)}if("market"==i){if("descend"==n)return d3.descending(e.DaysMarket,t.DaysMarket);if("ascend"==n)return d3.ascending(e.DaysMarket,t.DaysMarket)}if("change"==i){if("descend"==n)return d3.descending(e.PctChgfromAvg,t.PctChgfromAvg);if("ascend"==n)return d3.ascending(e.PctChgfromAvg,t.PctChgfromAvg)}if("distressed"==i){if("descend"==n)return d3.descending(e.PctDistressed,t.PctDistressed);if("ascend"==n)return d3.ascending(e.PctDistressed,t.PctDistressed)}if("price"==i){if("descend"==n)return d3.descending(e.diff,t.diff);if("ascend"==n)return d3.ascending(e.diff,t.diff)}if("family"==i){if("descend"==n)return d3.descending(e.PctSingleFamilyUnits,t.PctSingleFamilyUnits);if("ascend"==n)return d3.ascending(e.PctSingleFamilyUnits,t.PctSingleFamilyUnits)}if("renters"==i){if("descend"==n)return d3.descending(e.PctRenters,t.PctRenters);if("ascend"==n)return d3.ascending(e.PctRenters,t.PctRenters)}if("kids"==i){if("descend"==n)return d3.descending(e.PctKids,t.PctKids);if("ascend"==n)return d3.ascending(e.PctKids,t.PctKids)}if("income"==i){if("descend"==n)return d3.descending(e.MedianHHincome,t.MedianHHincome);if("ascend"==n)return d3.ascending(e.MedianHHincome,t.MedianHHincome)}}).transition().duration(500)}var l=s.cities,f=!1;d3.select("#cities").selectAll(".row").data(l.sort(function(e,t){return t.IndexScore-e.IndexScore})).enter().append("div").attr("class",function(e){return"Richfield"==e.name?"row selected":"row "}).style("background-color",function(e){var t="#888888";return e.IndexScore>=300?t="#118241":e.IndexScore>=240?t="#299e3d":e.IndexScore>=180?t="#5bbf48":e.IndexScore>=120?t="#9ee384":e.IndexScore>=0&&(t="#c7e5b5"),t}).style("color",function(e){var t="#000000";return e.IndexScore>=300&&(t="#ffffff"),t}).attr("latitude",function(e){return e.latitude}).attr("longitude",function(e){return e.longitude}).html(function(e,t){return"<div class='col name'>"+e.name+"</div><div class='col score'>"+e.IndexScore+"</div>"}),$(document).ready(function(){$(".row").hide();var e=$("#filter_box").val();$(".row").each(function(){-1!=$(this).text().toUpperCase().indexOf(e.toUpperCase())&&$(this).show()}),$(".row").each(function(){-1==$(this).text().toUpperCase().indexOf("(MPLS)")&&-1==$(this).text().toUpperCase().indexOf("(STP)")||$(this).hide()}),$("#filter_box").on("keyup search",function(e){$(".row").hide();var t=$("#filter_box").val();$(".row").each(function(){-1!=$(this).text().toUpperCase().indexOf(t.toUpperCase())&&$(this).show()})}),$(".th2").click(function(){if($(".th2").removeClass("selected3"),$(this).addClass("selected3"),$(this).hasClass("toggled")){$(this).removeClass("toggled");var e="ascend"}else if($(this).hasClass("selected3")){$(this).addClass("toggled");var e="descend"}r("#cities",null,l,$(this).attr("data"),e)})});var g=new mapboxgl.LngLat(-93.716125,44.643254),u=new mapboxgl.LngLat(-92.763062,45.350215);new mapboxgl.LngLatBounds(g,u);mapboxgl.accessToken="pk.eyJ1Ijoic2hhZG93ZmxhcmUiLCJhIjoiS3pwY1JTMCJ9.pTSXx_LFgR3XBpCNNxWPKA";var m=new mapboxgl.Map({container:"map",style:"mapbox://styles/shadowflare/ciqznymjs0009btm891qyu49n",center:[-93.28469849,45.01832962],zoom:7.8,minZoom:7.8});m.addControl(new mapboxgl.NavigationControl),m.scrollZoom.disable(),m.on("load",function(){$(".onoffswitch :checkbox").change(function(){this.checked?(f=!0,m.setLayoutProperty("stpnb-layer","visibility","none"),m.setLayoutProperty("mplsnb-layer","visibility","none"),m.setLayoutProperty("mncities-layer","visibility","visible"),m.setLayoutProperty("wicities-layer","visibility","visible"),o(),d("Richfield"),$(".row").removeClass("selected"),$(".row:contains('Richfield')").addClass("selected"),$(".row").show(),$(".row").each(function(){-1==$(this).text().toUpperCase().indexOf("(MPLS)")&&-1==$(this).text().toUpperCase().indexOf("(STP)")||$(this).hide()}),$("#cities").animate({scrollTop:0},800)):(f=!1,m.setLayoutProperty("stpnb-layer","visibility","visible"),m.setLayoutProperty("mplsnb-layer","visibility","visible"),m.setLayoutProperty("mncities-layer","visibility","none"),m.setLayoutProperty("wicities-layer","visibility","none"),m.jumpTo({center:[-93.202515,44.969656],zoom:11.5,pitch:0,bearing:0}),d("(MPLS) Bottineau"),$(".row").removeClass("selected"),$(".row:contains('(MPLS) Bottineau')").addClass("selected"),$(".row").hide(),$(".row").each(function(){-1==$(this).text().toUpperCase().indexOf("(MPLS)")&&-1==$(this).text().toUpperCase().indexOf("(STP)")||$(this).show()}),$("#cities").animate({scrollTop:0},800)),console.log(f)}),$(".zoom").click(function(){m.jumpTo({center:[-93.28469849,45.01832962],zoom:7.8,pitch:0,bearing:0}),$("#cities").animate({scrollTop:0},800),$(".row").removeClass("selected"),$(".row:contains('Richfield')").addClass("selected"),d("Richfield"),e.remove()}),m.addSource("mncities",{type:"geojson",data:t}),m.addLayer({id:"mncities-layer",interactive:!0,source:"mncities",layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.8,"fill-color":{property:"index_IndexScore",type:"interval",stops:[[0,"#888888"],[50,"#c7e5b5"],[120,"#9ee384"],[180,"#5bbf48"],[240,"#299e3d"],[300,"#118241"]]},"fill-outline-color":"rgba(255, 255, 255, 0.1)"}},"place-neighbourhood"),m.addSource("wicities",{type:"geojson",data:i}),m.addLayer({id:"wicities-layer",interactive:!0,source:"wicities",layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.8,"fill-color":{property:"index_IndexScore",type:"interval",stops:[[0,"#888888"],[50,"#c7e5b5"],[120,"#9ee384"],[180,"#5bbf48"],[240,"#299e3d"],[300,"#118241"]]},"fill-outline-color":"rgba(255, 255, 255, 0)"}},"place-neighbourhood"),m.addSource("mplsnb",{type:"geojson",data:n}),m.addLayer({id:"mplsnb-layer",interactive:!0,source:"mplsnb",layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.8,"fill-color":{property:"nbindex_IndexScore",type:"interval",stops:[[0,"#888888"],[50,"#c7e5b5"],[120,"#9ee384"],[180,"#5bbf48"],[240,"#299e3d"],[300,"#118241"]]},"fill-outline-color":"rgba(255, 255, 255, 0.4)"}},"place-neighbourhood"),m.addSource("stpnb",{type:"geojson",data:a}),m.addLayer({id:"stpnb-layer",interactive:!0,source:"stpnb",layout:{},type:"fill",paint:{"fill-antialias":!0,"fill-opacity":.8,"fill-color":{property:"nbindex_IndexScore",type:"interval",stops:[[0,"#888888"],[50,"#c7e5b5"],[120,"#9ee384"],[180,"#5bbf48"],[240,"#299e3d"],[300,"#118241"]]},"fill-outline-color":"rgba(255, 255, 255, 0.4)"}},"place-neighbourhood"),m.setLayoutProperty("stpnb-layer","visibility","none"),m.setLayoutProperty("mplsnb-layer","visibility","none");var e=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});$(".row").on("mousedown click",function(t){$(".row").removeClass("selected"),$(this).addClass("selected");var i=$(this).attr("longitude"),n=$(this).attr("latitude");-1!=$(this).find(".name").text().indexOf("(MPLS)")||-1!=$(this).find(".name").text().indexOf("(STP)")?m.jumpTo({center:[i,n],zoom:13.5,pitch:0,bearing:0}):m.jumpTo({center:[i,n],zoom:10,pitch:0,bearing:0}),d($(this).find(".name").text()),e.remove();var a=m.queryRenderedFeatures(t.point,{layers:["mncities-layer"]});if(m.getCanvas().style.cursor=a.length?"pointer":"",!a.length)return void e.remove();a[0];e.setLngLat([$(this).attr("longitude"),$(this).attr("latitude")]).setHTML("&nbsp;").addTo(m)})}),function(){$("#chartHead").html('<div class="cell stretch th" data="name">Community</div>       <div class="cell th selected" data="index">Housing market index score</div>       <div class="cell th" data="market">average days on market</div>       <div class="cell th" data="change">% change price per sq. ft.*</div>       <div class="cell th" data="distressed">% distressed properties</div>       <div class="cell th" data="price">change in market days</div>       <div class="cell th hideme" data="family">% single family</div>       <div class="cell th hideme" data="renters">% renters</div>       <div class="cell th hideme" data="kids">% kids</div>       <div class="cell th hideme" data="income">median income</div>'),d3.select("#chartHighlights").selectAll(".listrow").data(l.filter(function(e){return e.IndexScore>=250}).sort(function(e,t){return t.IndexScore-e.IndexScore})).enter().append("div").attr("class",function(e){return"listrow "}).style("background-color",function(e){}).html(function(e,t){var i="",n="",a="",s="",r="",o="",d="",c="",l="";return e.IndexScore>=300?i="orange5":e.IndexScore>=240?i="orange4":e.IndexScore>=180?i="orange3":e.IndexScore>=120?i="orange2":e.IndexScore>=0&&(i="orange1"),e.DaysMarket>=120?n="orange1":e.DaysMarket>=90?n="orange2":e.DaysMarket>=60?n="orange3":e.DaysMarket>=30?n="orange4":e.DaysMarket>=0&&(n="orange5"),e.PctChgfromAvg>=.2?a="orange5":e.PctChgfromAvg>=.15?a="orange4":e.PctChgfromAvg>=.1?a="orange3":e.PctChgfromAvg>=.05?a="orange2":e.PctChgfromAvg>=0&&(a="orange1"),e.PctDistressed>=.08?s="orange5":e.PctDistressed>=.06?s="orange4":e.PctDistressed>=.04?s="orange3":e.PctDistressed>=.02?s="orange2":e.PctDistressed>=0&&(s="orange1"),e.diff>=20?r="orange1":e.diff>=10?r="orange2":e.diff>=0?r="orange3":e.diff<=-10?r="orange5":e.diff<=0&&(r="orange4"),e.PctSingleFamilyUnits>=.9?o="orange5":e.PctSingleFamilyUnits>=.7?o="orange4":e.PctSingleFamilyUnits>=.5?o="orange3":e.PctSingleFamilyUnits>=.3?o="orange2":e.PctSingleFamilyUnits>=0&&(o="orange1"),e.PctRenters>=.4?d="orange5":e.PctRenters>=.3?d="orange4":e.PctRenters>=.2?d="orange3":e.PctRenters>=.1?d="orange2":e.PctRenters>=0&&(d="orange1"),e.PctKids>=.4?c="orange5":e.PctKids>=.3?c="orange4":e.PctKids>=.2?c="orange3":e.PctKids>=.1?c="orange2":e.PctKids>=0&&(c="orange1"),e.MedianHHincome>=11e4?l="orange5":e.MedianHHincome>=9e4?l="orange4":e.MedianHHincome>=7e4?l="orange3":e.MedianHHincome>=5e4?l="orange2":e.MedianHHincome>=3e4&&(l="orange1"),'<div class="cell stretch">'+e.name+'</div>       <div class="cell '+i+' index"><span class="value index">'+e.IndexScore+'</span></div>       <div class="cell '+n+' "><span class="value">'+e.DaysMarket+'</span></div>       <div class="cell '+a+'"><span class="value">'+d3.format("+%")(e.PctChgfromAvg)+'</span></div>       <div class="cell '+s+'"><span class="value">'+d3.format("+%.0f")(e.PctDistressed)+'</span></div>       <div class="cell '+r+'"><span class="value">'+d3.format("+.0f")(e.diff)+'</span></div>       <div class="cell '+o+' hideme"><span class="value">'+d3.format("%.0f")(e.PctSingleFamilyUnits)+'</span></div>       <div class="cell '+d+' hideme"><span class="value">'+d3.format("%.0f")(e.PctRenters)+'</span></div>       <div class="cell '+c+' hideme"><span class="value">'+d3.format("%.0f")(e.PctKids)+'</span></div>       <div class="cell '+l+' hideme"><span class="value">'+d3.format("$,")(e.MedianHHincome)+"</span></div>"}),$(".th").click(function(){if($(".th").removeClass("selected"),$(this).addClass("selected"),$(this).hasClass("toggled")){$(this).removeClass("toggled");var e="ascend"}else if($(this).hasClass("selected")){$(this).addClass("toggled");var e="descend"}c("#chartHighlights",l,$(this).attr("data"),e)}),$(".stretch").mouseover(function(){$(".value").hide(),$(this).parent().find(".value").show()})}();var p=l.filter(function(e){return"Richfield"==e.name}),h={top:40,right:40,bottom:30,left:40},P=c3.generate({bindto:"#chart",padding:h,data:{x:"x",columns:[["x","2003-01-01","2004-01-01","2005-01-01","2006-01-01","2007-01-01","2008-01-01","2009-01-01","2010-01-01","2011-01-01","2012-01-01","2013-01-01","2014-01-01","2015-01-01","2016-01-01","2017-01-01"],["PPSF",p[0].PPSF2003,p[0].PPSF2004,p[0].PPSF2005,p[0].PPSF2006,p[0].PPSF2007,p[0].PPSF2008,p[0].PPSF2009,p[0].PPSF2010,p[0].PPSF2011,p[0].PPSF2012,p[0].PPSF2013,p[0].PPSF2014,p[0].PPSF2015,p[0].PPSF2016,p[0].PPSF2016]],names:{PPSF:"Price per sq. ft."},colors:{PPSF:"#333333"}},legend:{show:!1},axis:{y:{max:400,min:0,padding:{bottom:0,top:0},tick:{count:4,format:d3.format("$.0f")}},x:{type:"timeseries",padding:{right:0,left:0},tick:{format:"%Y"}}}});d3.select("#chart svg").append("text").attr("x",50).attr("y",50).style("text-anchor","right").text("Price per square foot over time"),d("Richfield")})})})})}),function(){var e={top:40,right:20,bottom:30,left:60};c3.generate({bindto:"#chartMarket",padding:e,data:{xs:{DaysMarket15:"cities3",DaysMarket16:"cities",DaysMarket17:"cities2"},columns:[["cities",2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104],["DaysMarket16",40,49,48,47,48,58,52,53,81,46,56,48,46,58,60,54,53,50,51,51,52,55,48,63,59,52,54,56,51,55,50,79,65,55,51,53,87,62,51,81,60,56,71,55,56,64,62,61,70,48,50,59,137,63,63,57,62,93,52,57,61,112,77,54,60,61,68,67,75,56,51,71,81,66,119,96,75,58,78,104,82,111,69,69,85,86,96,69,73,65,74,124,89,158,91,74,75,89,119,72,70,128,137],["cities2",2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104],["DaysMarket17",29,37,43,35,37,37,37,37,65,36,42,42,36,50,45,43,47,41,39,36,41,45,38,43,49,41,39,72,49,44,46,55,52,45,43,45,82,51,50,56,51,46,63,49,50,53,49,46,47,43,43,47,144,56,52,52,46,76,61,54,44,89,74,49,59,62,55,59,55,61,41,76,58,56,94,88,70,56,59,94,70,87,60,88,75,74,77,63,62,52,68,110,93,135,61,78,64,73,138,100,73,134,120]],type:"scatter",colors:{DaysMarket15:"#857AAA",DaysMarket16:"#271D42",DaysMarket17:"#299e3d"}},legend:{show:!1},tooltip:{show:!1},axis:{x:{show:!1,tick:{fit:!1},height:60},y:{max:160,min:0,padding:{bottom:0,top:0,right:0,left:0},label:{text:"⬅ Average days on market",position:"outer-center"}}}})}()},{}]},{},[1]);